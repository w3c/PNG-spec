name: "Formating checker"

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  HTML-Tidy:
    runs-on: [ubuntu-latest]

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Install HTML Tidy
      run: sudo apt install tidy

    - name: Run HTML Tidy
      run: tidy -f new-tidy-results -config tidy.cfg -e index.html || true

    - name: Checkout main
      uses: actions/checkout@v3
      with:
        ref: main

    - name: Run HTML Tidy
      run: tidy -f old-tidy-results -config tidy.cfg -e index.html || true

    - name: Diff HTML Tidy results
      run: diff -u old-tidy-results new-tidy-results | grep -E "^\+"
